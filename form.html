<!DOCTYPE html>  <html lang="en">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>  
<title>Smart RTI Form</title>  <!-- BACKENDLESS -->  <script src="https://unpkg.com/backendless/dist/backendless.min.js"></script>  <!-- LOAD DATASET -->  <script src="dataset.js"></script>  <style>  
  * { box-sizing: border-box; margin:0; padding:0; font-family:'Poppins', sans-serif; }  
  body {  
    background: linear-gradient(135deg,#74ebd5,#ACB6E5);  
    min-height:100vh; display:flex; justify-content:center; align-items:flex-start;  
    padding:20px;  
  }  
  .container {  
    width:100%; max-width:850px; background: rgba(255,255,255,0.15);  
    backdrop-filter: blur(12px); border-radius:15px; padding:25px;  
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);  
  }  
  h2 { text-align:center; margin-bottom:20px; color:#333; }  
  
  .logout-btn {  
    float:right; background:#ff4b5c; color:white; border:none; padding:8px 16px;  
    border-radius:8px; cursor:pointer; transition:0.3s;  
  }  
  .logout-btn:hover { background:#ff2b3c; }  
  
  form input, form select, form textarea {  
    width:100%; padding:12px; margin:8px 0; border-radius:8px;  
    border:none; outline:none; font-size:15px;  
  }  
  form input:focus, form select:focus, form textarea:focus {  
    box-shadow: 0 0 5px #74ebd5;  
  }  
  form textarea { min-height:100px; resize:vertical; }  
  
  .captcha-row { display:flex; align-items:center; gap:10px; margin:10px 0; }  
  #captchaBox {  
    background:#222; color:#fff; font-weight:bold; font-size:18px;  
    padding:10px 15px; border-radius:8px; letter-spacing:2px; text-align:center;  
  }  
  #captchaRefresh { background:#444; color:white; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; }  
  
  .submit-btn, .ai-btn {  
    background:#007BFF; color:white; border:none; padding:12px; border-radius:10px;  
    cursor:pointer; width:100%; margin:10px 0; font-size:16px; transition:0.3s;  
  }  
  
  /* Live AI / validation messages */  
  #liveMsg {  
    color:red;  
    font-weight:bold;  
    margin-bottom:10px;  
    white-space: pre-line; /* preserves line breaks */  
  }  
</style>  </head>  <body>  <div class="container">  <button class="logout-btn" onclick="logout()">Logout</button>

  <h2>Smart RTI Form</h2>    <form id="rtiForm">  <label for="regNo">Registration No</label>
<input type="text" id="regNo" readonly>
<!-- STATE -->
<select id="state" required onchange="loadDepartments()">
<option value="">Select State/UT</option>
</select>

<!-- DEPARTMENT -->  
<select id="department" required onchange="loadSubjectHints()">  
  <option value="">Select Department</option>  
</select>  

<input type="text" id="name" placeholder="Full Name" required />  

<select id="gender" required>  
  <option value="">Select Gender</option>  
  <option>Male</option>  
  <option>Female</option>  
  <option>Other</option>  
</select>  

<input type="number" id="age" placeholder="Age" required />  
<input type="text" id="addr1" placeholder="Address Line 1" required />  
<input type="text" id="addr2" placeholder="Address Line 2" />  
<input type="text" id="addr3" placeholder="Address Line 3" />  
<input type="text" id="pincode" placeholder="Pincode" required />  
<input type="text" id="mobile" placeholder="Mobile Number" required />  
<input type="email" id="email" placeholder="Email" required />  

<input type="text" id="subject" placeholder="Subject / Topic of RTI" required />  
<textarea id="rtiText" placeholder="Detailed RTI Question / Text" required></textarea>  

<select id="language" required>  
  <option value="">Select Language</option>  
  <option>English</option>  
  <option>Hindi</option>  
  <option>Marathi</option>  
  <option>Tamil</option>  
  <option>Telugu</option>  
  <option>Bengali</option>  
  <option>Gujarati</option>  
  <option>Kannada</option>  
  <option>Malayalam</option>  
  <option>Odia</option>  
</select>  

<!-- CAPTCHA -->  
<div class="captcha-row">  
  <div id="captchaBox"></div>  
  <input type="text" id="captchaInput" placeholder="Enter Captcha" />  
  <button type="button" id="captchaRefresh">Refresh</button>  
</div>  

<!-- Live AI / validation message above AI button -->  
<div id="liveMsg"></div>  

<button type="button" class="ai-btn" onclick="aiVerifyRTI()">AI Verify Information</button>  
<button type="button" class="submit-btn" onclick="submitRTI()">Submit RTI</button>

  </form>  
</div>  
<script src="https://api.backendless.com/sdk/js/latest/backendless.min.js"></script>  

<script>

// ====== HELPER ======
const id = x => document.getElementById(x);

// ====== BACKENDLESS INIT ======
Backendless.initApp(
  "A1EFA0A2-9F5F-4AB4-B41A-34610BD8119F",
  "F7F4D0E1-9677-4715-8C0E-F1FD819B9D69"
);

// ====== LOGIN CHECK ======
if (!localStorage.getItem("userRole")) {
  id("liveMsg").innerText = "⚠️ Please login first!";
  setTimeout(() => window.location.href = "login.html", 2000);
}

// ====== LOGOUT ======
function logout() {
  localStorage.clear();
  id("liveMsg").innerText = "Logged out!";
  setTimeout(() => window.condition ? true : falselocation.href = "login.html", 1000);
}

// ====== PINCODE RANGE ======
const PINCODE_RANGE = {
  "Andhra Pradesh": [500000, 539999],
  "Arunachal Pradesh": [790000, 792999],
  "Assam": [780000, 789999],
  "Bihar": [800000, 855999],
  "Chhattisgarh": [490000, 499999],
  "Goa": [403000, 403999],
  "Gujarat": [360000, 396999],
  "Haryana": [121000, 135999],
  "Himachal Pradesh": [171000, 177999],
  "Jharkhand": [814000, 834999],
  "Karnataka": [560000, 591999],
  "Kerala": [670000, 695999],
  "Madhya Pradesh": [450000, 488999],
  "Maharashtra": [400000, 445999],
  "Manipur": [795000, 795999],
  "Meghalaya": [793000, 794999],
  "Mizoram": [796000, 796999],
  "Nagaland": [797000, 798999],
  "Odisha": [750000, 770999],
  "Punjab": [140000, 160999],
  "Rajasthan": [300000, 345999],
  "Sikkim": [737000, 737999],
  "Tamil Nadu": [600000, 643999],
  "Telangana": [500000, 509999],
  "Tripura": [799000, 799999],
  "Uttar Pradesh": [200000, 285999],
  "Uttarakhand": [244000, 263999],
  "West Bengal": [700000, 743999]
};

// ====== STATES & DEPARTMENTS ======
function loadStates() {
  const dropdown = id("state");
  Object.keys(RTI_DATASET).forEach(state => {
    const op = document.createElement("option");
    op.value = state;
    op.textContent = state;
    dropdown.appendChild(op);
  });
}
loadStates();

function loadDepartments() {
  const state = id("state").value;
  const depBox = id("department");
  depBox.innerHTML = '<option value="">Select Department</option>';
  if (RTI_DATASET[state]) {
    Object.keys(RTI_DATASET[state]).forEach(dep => {
      const op = document.createElement("option");
      op.value = dep;
      op.textContent = dep;
      depBox.appendChild(op);
    });
  }
}

function loadSubjectHints() {
  const s = id("state").value;
  const d = id("department").value;
  if (!s || !d) return;
  const hints = RTI_DATASET[s][d];
  id("subject").placeholder = "Examples: " + hints.slice(0, 3).join(", ");
}

// ====== CAPTCHA ======
let generatedCaptcha = "";
function generateCaptcha() {
  const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  generatedCaptcha = "";
  for (let i = 0; i < 5; i++) {
    generatedCaptcha += chars[Math.floor(Math.random() * chars.length)];
  }
  id("captchaBox").innerText = generatedCaptcha;
}
id("captchaRefresh").onclick = generateCaptcha;
generateCaptcha();

// ====== VALIDATIONS ======
function isValidName(name) { return /^[A-Za-z ]+$/.test(name); }
function isValidEmail(email) { return /^[A-Za-z0-9._%+-]+@(gmail|yahoo|outlook|gov|nic)\.(com|in|gov|nic)$/.test(email); }
function isValidAddress(addr) { return addr.length >= 8; }
function verifyPincode(state, pin) {
  if (!PINCODE_RANGE[state]) return true;
  const [min, max] = PINCODE_RANGE[state];
  return pin >= min && pin <= max;
}

// ====== AI VERIFY ======
function aiVerifyRTI() {
  const state = id("state").value;
  const dep = id("department").value;
  const subject = id("subject").value.toLowerCase();
  const msgDiv = id("liveMsg");

  if (!state || !dep || !subject) {
    msgDiv.innerText = "⚠️ Please select state, department & enter subject first";
    return;
  }

  const hints = RTI_DATASET[state][dep];
  const keywords = hints.flatMap(x => x.toLowerCase().split(" "));
  let matchCount = 0;
  const subjectWords = subject.split(" ");
  subjectWords.forEach(word => { if (keywords.includes(word)) matchCount++; });
  const matchPercent = Math.round((matchCount / subjectWords.length) * 100);

  if (matchPercent >= 50) {
    msgDiv.innerText = `✅ AI Verification Passed \nState: ${state} | Department: ${dep} | Subject: ${id("subject").value} | Match Score: ${matchPercent}% \nRemarks: Most likely correct`;
  } else {
    msgDiv.innerText = `⚠️ AI Verification Warning \nState: ${state} | Department: ${dep} | Subject: ${id("subject").value} | Match Score: ${matchPercent}%`;
  }
}

// ====== SUBMIT RTI ======
async function submitRTI() {
  const msgDiv = id("liveMsg");
  const state = id("state").value;
  const pin = parseInt(id("pincode").value);

  if (id("captchaInput").value !== generatedCaptcha) { msgDiv.innerText = "❌ Invalid Captcha!"; return; }
  if (!isValidName(id("name").value)) { msgDiv.innerText = "❌ Invalid Name! Only alphabets allowed."; return; }
  if (!isValidEmail(id("email").value)) { msgDiv.innerText = "❌ Invalid Email! Use valid domain like gmail/outlook/gov."; return; }
  if (!isValidAddress(id("addr1").value)) { msgDiv.innerText = "❌ Address Line 1 too short!"; return; }
  if (!verifyPincode(state, pin)) { msgDiv.innerText = `❌ Pincode does NOT match ${state}!`; return; }

  const data = {
    regNo: id("regNo").value,
    state: state,
    department: id("department").value,
    name: id("name").value,
    gender: id("gender").value,
    age: id("age").value,
    addr1: id("addr1").value,
    addr2: id("addr2").value,
    addr3: id("addr3").value,
    pincode: id("pincode").value,
    mobile: id("mobile").value,
    email: id("email").value,
    subject: id("subject").value,
    rtiText: id("rtiText").value,
    language: id("language").value,
    createdAt: new Date().toISOString(),
    status: "new"
  };

  await Backendless.Data.of("RTI_Forms").save(data);
  msgDiv.innerText = "✅ RTI Submitted Successfully!";
  id("rtiForm").reset();
  generateCaptcha();
}

// ====== REGISTRATION NUMBER ======
function generateRegNo() {
  const prefix = "RTI";
  const date = new Date();
  const dd = String(date.getDate()).padStart(2,'0');
  const mm = String(date.getMonth()+1).padStart(2,'0');
  const yy = String(date.getFullYear()).slice(-2);
  const random = Math.floor(1000 + Math.random()*9000);
  return `${prefix}-${dd}${mm}${yy}-${random}`;
}
id("regNo").value = generateRegNo();

// ====== LANGUAGE TRANSLATIONS ======
const TRANSLATIONS = {
  "English": { regNo:"Registration No", state:"Select State/UT", department:"Select Department", name:"Full Name", gender:"Select Gender", age:"Age", addr1:"Address Line 1", addr2:"Address Line 2", addr3:"Address Line 3", pincode:"Pincode", mobile:"Mobile Number", email:"Email", subject:"Subject / Topic of RTI", rtiText:"Detailed RTI Question / Text", language:"Select Language", captcha:"Enter Captcha", aiBtn:"AI Verify Information", submitBtn:"Submit RTI", logoutBtn:"Logout" },
  "Hindi": { regNo:"पंजीकरण संख्या", state:"राज्य/संघ शासित प्रदेश चुनें", department:"विभाग चुनें", name:"पूरा नाम", gender:"लिंग चुनें", age:"आयु", addr1:"पता लाइन 1", addr2:"पता लाइन 2", addr3:"पता लाइन 3", pincode:"पिनकोड", mobile:"मोबाइल नंबर", email:"ईमेल", subject:"RTI विषय / शीर्षक", rtiText:"विस्तृत RTI प्रश्न / विवरण", language:"भाषा चुनें", captcha:"कैप्चा दर्ज करें", aiBtn:"AI सत्यापित करें", submitBtn:"RTI जमा करें", logoutBtn:"लॉग आउट" },
  "Marathi": { regNo:"नोंदणी क्रमांक", state:"राज्य/केंद्रशासित प्रदेश निवडा", department:"विभाग निवडा", name:"पूर्ण नाव", gender:"लिंग निवडा", age:"वय", addr1:"पत्ता ओळ 1", addr2:"पत्ता ओळ 2", addr3:"पत्ता ओळ 3", pincode:"पिनकोड", mobile:"मोबाईल नंबर", email:"ईमेल", subject:"RTI विषय / शिर्षक", rtiText:"सविस्तर RTI प्रश्न / मजकूर", language:"भाषा निवडा", captcha:"कॅप्चा प्रविष्ट करा", aiBtn:"AI सत्यापित करा", submitBtn:"RTI सबमिट करा", logoutBtn:"लॉगआउट" },
  "Tamil": { regNo:"பதிவு எண்", state:"மாநிலம்/குடியரசுத் தலைவர் பிரதேசம் தேர்ந்தெடுக்கவும்", department:"துறை தேர்ந்தெடுக்கவும்", name:"முழு பெயர்", gender:"பாலினம் தேர்ந்தெடுக்கவும்", age:"வயது", addr1:"முகவரி வரி 1", addr2:"முகவரி வரி 2", addr3:"முகவரி வரி 3", pincode:"பின்கோட்", mobile:"மொபைல் எண்", email:"மின்னஞ்சல்", subject:"RTI பொருள் / தலைப்பு", rtiText:"விரிவான RTI கேள்வி / உரை", language:"மொழியை தேர்ந்தெடுக்கவும்", captcha:"கேப்ட்சா உள்ளிடவும்", aiBtn:"AI சோதனை", submitBtn:"RTI சமர்ப்பி", logoutBtn:"வெளியேறு" },
  "Telugu": { regNo:"నమోదు సంఖ్య", state:"రాజ్యాన్ని/కేంద్రపాలిత ప్రాంతాన్ని ఎంచుకోండి", department:"విభాగాన్ని ఎంచుకోండి", name:"పూర్తి పేరు", gender:"లింగం ఎంచుకోండి", age:"వయసు", addr1:"చిరునామా లైన్ 1", addr2:"చిరునామా లైన్ 2", addr3:"చిరునామా లైన్ 3", pincode:"పిన్‌కోడ్", mobile:"మొబైల్ నంబర్", email:"ఈమెయిల్", subject:"RTI విషయం / శీర్షిక", rtiText:"వివరమైన RTI ప్రశ్న / వచనం", language:"భాషను ఎంచుకోండి", captcha:"క్యాప్చాను నమోదు చేయండి", aiBtn:"AI ధృవీకరణ", submitBtn:"RTI సమర్పించు", logoutBtn:"లాగ్ అవుట్" },
  "Bengali": { regNo:"নিবন্ধন নম্বর", state:"রাজ্য/কেন্দ্র শাসিত অঞ্চল নির্বাচন করুন", department:"বিভাগ নির্বাচন করুন", name:"পূর্ণ নাম", gender:"লিঙ্গ নির্বাচন করুন", age:"বয়স", addr1:"ঠিকানা লাইন 1", addr2:"ঠিকানা লাইন 2", addr3:"ঠিকানা লাইন 3", pincode:"পিনকোড", mobile:"মোবাইল নম্বর", email:"ইমেইল", subject:"RTI বিষয় / শিরোনাম", rtiText:"বিস্তারিত RTI প্রশ্ন / লেখা", language:"ভাষা নির্বাচন করুন", captcha:"ক্যাপচা লিখুন", aiBtn:"AI যাচাই করুন", submitBtn:"RTI জমা দিন", logoutBtn:"লগআউট" },
  "Gujarati": { regNo:"રજીસ્ટ્રેશન નંબર", state:"રાજ્ય/કેન્દ્રશાસિત પ્રદેશ પસંદ કરો", department:"વિભાગ પસંદ કરો", name:"પૂર્ણ નામ", gender:"લિંગ પસંદ કરો", age:"ઉંમર", addr1:"સરનામું લાઇન 1", addr2:"સરનામું લાઇન 2", addr3:"સરનામું લાઇન 3", pincode:"પિનકોડ", mobile:"મોબાઇલ નંબર", email:"ઈમેલ", subject:"RTI વિષય / શીર્ષક", rtiText:"વિસ્તૃત RTI પ્રશ્ન / લખાણ", language:"ભાષા પસંદ કરો", captcha:"કૅપ્ચા દાખલ કરો", aiBtn:"AI ચકાસો", submitBtn:"RTI સબમિટ કરો", logoutBtn:"લૉગ આઉટ" },
  "Kannada": { regNo:"ನೋಂದಣಿ ಸಂಖ್ಯೆ", state:"ರಾಜ್ಯ/ಕೇಂದ್ರಾಡಳಿತ ಪ್ರದೇಶ ಆಯ್ಕೆಮಾಡಿ", department:"ವಿಭಾಗ ಆಯ್ಕೆಮಾಡಿ", name:"ಪೂರ್ಣ ಹೆಸರು", gender:"ಲಿಂಗ ಆಯ್ಕೆಮಾಡಿ", age:"ವಯಸ್ಸು", addr1:"ವಿಳಾಸ ಸಾಲು 1", addr2:"ವಿಳಾಸ ಸಾಲು 2", addr3:"ವಿಳಾಸ ಸಾಲು 3", pincode:"ಪಿನ್ ಕೋಡ್", mobile:"ಮೊಬೈಲ್ ಸಂಖ್ಯೆ", email:"ಇಮೇಲ್", subject:"RTI ವಿಷಯ / ಶೀರ್ಷಿಕೆ", rtiText:"ವಿಸ್ತೃತ RTI ಪ್ರಶ್ನೆ / ಪಠ್ಯ", language:"ಭಾಷೆ ಆಯ್ಕೆಮಾಡಿ", captcha:"ಕ್ಯಾಪ್ಚಾ ನಮೂದಿಸಿ", aiBtn:"AI ಪರಿಶೀಲನೆ", submitBtn:"RTI ಸಲ್ಲಿಸಿ", logoutBtn:"ಲಾಗ್ ಔಟ್" },
  "Malayalam": { regNo:"രജിസ്ട്രേഷൻ നമ്പർ", state:"സംസ്ഥാനം/കേന്ദ്രഭരണ പ്രദേശം തിരഞ്ഞെടുക്കുക", department:"വിഭാഗം തിരഞ്ഞെടുക്കുക", name:"പൂർണ്ണ പേര്", gender:"ലിംഗം തിരഞ്ഞെടുക്കുക", age:"വയസ്സ്", addr1:"വിലാസം വരി 1", addr2:"വിലാസം വരി 2", addr3:"വിലാസം വരി 3", pincode:"പിന്കോഡ്", mobile:"മൊബൈൽ നമ്പർ", email:"ഇമെയിൽ", subject:"RTI വിഷയം / ശീർഷകം", rtiText:"വിസ്തൃതമായ RTI ചോദ്യങ്ങൾ / എഴുത്ത്", language:"ഭാഷ തിരഞ്ഞെടുക്കുക", captcha:"ക്യാപ്ച ഏടുക", aiBtn:"AI പരിശോധന", submitBtn:"RTI സമർപ്പിക്കുക", logoutBtn:"ലോഗ്ഔട്ട്" },
  "Odia": { regNo:"ପଞ୍ଜୀକରଣ ସଂଖ୍ୟା", state:"ରାଜ୍ୟ/କେନ୍ଦ୍ରପାଳିତ ଅଞ୍ଚଳ ବାଛନ୍ତୁ", department:"ବିଭାଗ ବାଛନ୍ତୁ", name:"ସମ୍ପୂର୍ଣ୍ଣ ନାମ", gender:"ଲିଙ୍ଗ ବାଛନ୍ତୁ", age:"ବୟସ୍କ", addr1:"ଠିକଣା ଲାଇନ୍ 1", addr2:"ଠିକଣା ଲାଇନ୍ 2", addr3:"ଠିକଣା ଲାଇନ୍ 3", pincode:"ପିନକୋଡ", mobile:"ମୋବାଇଲ୍ ନମ୍ବର", email:"ଇମେଲ୍", subject:"RTI ବିଷୟ / ଶୀର୍ଷକ", rtiText:"ବିସ୍ତୃତ RTI ପ୍ରଶ୍ନ / ଟେକ୍ସଟ୍", language:"ଭାଷା ବାଛନ୍ତୁ", captcha:"କ୍ୟାପଚା ପ୍ରବେଶ କରନ୍ତୁ", aiBtn:"AI ସତ୍ୟାପନା", submitBtn:"RTI ସମର୍ପଣ କରନ୍ତୁ", logoutBtn:"ଲଗଅଉଟ୍" }
};

// UPDATE FORM LANGUAGE
function updateFormLanguage(lang){
    const t = TRANSLATIONS[lang];
    if(!t) return;

    id("regNo").placeholder = t.regNo;
    id("state").options[0].text = t.state;
    id("department").options[0].text = t.department;
    id("name").placeholder = t.name;
    id("gender").options[0].text = t.gender;
    id("age").placeholder = t.age;
    id("addr1").placeholder = t.addr1;
    id("addr2").placeholder = t.addr2;
    id("addr3").placeholder = t.addr3;
    id("pincode").placeholder = t.pincode;
    id("mobile").placeholder = t.mobile;
    id("email").placeholder = t.email;
    id("subject").placeholder = t.subject;
    id("rtiText").placeholder = t.rtiText;
    id("language").options[0].text = t.language;
    id("captchaInput").placeholder = t.captcha;
    document.querySelector(".ai-btn").innerText = t.aiBtn;
    document.querySelector(".submit-btn").innerText = t.submitBtn;
    document.querySelector(".logout-btn").innerText = t.logoutBtn;
}

// LISTENER
id("language").addEventListener("change", function(){
    updateFormLanguage(this.value);
});
</script>

</body>  
</html>  